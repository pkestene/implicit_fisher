This code adapted from https://github.com/eth-cscs/SummerSchool2019
